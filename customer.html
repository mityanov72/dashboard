<HTML>
<HEAD>

<meta charset="utf-8">
<script src="math.js"></script>
<script src="classes.js"></script>
<script src="engine_db.js"></script>
<script src="engine_console.js"></script>
<script src="engine_web.js"></script>
<script src="application.js"></script>
<script src="tables.js"></script>
<script src="menu.js"></script>

<link href="style.css" rel="stylesheet">
<link href="tables.css" rel="stylesheet">
<link href="popup.css" rel="stylesheet">

<script>
window.onload = function() {
	createMenu();
	
	var div_table = document.getElementById('div_customer_list');
	fillTable(div_table, HTML_TABLE_CUSTOMER, 'SELECT GUID, title AS customer_title FROM customer', [], 'SELECT COUNT(1) FROM customer', []);
}

function tableCustomerClick(sender) {
	for(let i=0; i < sender.childNodes.length; i++) {
		let cell_current = sender.childNodes[i];
		if(cell_current.getAttribute('data-name') == 'GUID') {
			localStorage['param_customer_GUID'] = cell_current.innerText;
			window.location = 'customer_description.html';
		}
	}
}

function addCustomer() {
	let customer_title = document.getElementById('customer_title');
	let customer_town = document.getElementById('customer_town');
	customer_title = customer_title.value;
	customer_town = customer_town.value;
	EngineDB.addCustomer(customer_title, customer_town);
	closePopup();
}


</script>
</HEAD>
<BODY>
<div class='top_menu' id='top_menu'></div>

<div>
	<a href=# onclick='showPopup()'>add customer</a>
</div>
<div class='visual_table'>
	<table class='visual_table' id='div_customer_list' width='100%' data-function='tableCustomerClick'>
		<caption>Customer table</caption>
		<thead></thead>
		<tbody></tbody>
		<tfoot></tfoot>
	</table>
</div>

<div class='div_popup' id='div_popup' style='display: none'>
	<div class='visual_table'>
	<table class='edit_table'>
		<tr><td>customer title</td>		<td><input type='text' id='customer_title'></td></tr>
		<tr><td>customer town</td>		<td><input type='text' id='customer_town'></td></tr>
		<tr><td></td>	<td><a href=# onclick='addCustomer(); return false' class='link_button'>add</a></td></tr>
		<tr><td></td>	<td><a href=# onclick='closePopup(); return false' class='link_button'>cancel</a></td></tr>
	</table>
	</div>
</div>

<div class='div_footer'></div>
</BODY>
</HTML>